{"componentChunkName":"component---src-templates-post-template-tsx","path":"/keep-github-action-enabled/","result":{"data":{"markdownRemark":{"id":"6feeaff7-ef80-569d-b026-46804ff316e5","html":"<h2>Github Action은 왜 멈출까</h2>\n<p>필요하지 않은 workflow가 작동하는 걸 방지하기 위해, Github은 해당 레포에 60일간 커밋이 생기지 않으면 크론 작업을 비활성화한다고 한다. <a href=\"https://docs.github.com/ko/actions/managing-workflow-runs-and-deployments/managing-workflow-runs/disabling-and-enabling-a-workflow\">공식문서</a></p>\n<p>나의 경우, Gist를 업데이트해서 Github 프로필을 꾸미는 <a href=\"https://github.com/techinpark/productive-box\">productive-box</a>와 <a href=\"https://github.com/bokub/github-stats-box\">github-stats-box</a>를 사용하고 있다.<br>\n이 두 레포지토리는 커밋이 생길리가 없기 때문에... 매번 수동으로 workflow를 enable 해줘야 한다는 단점이 있었다.</p>\n<p>오늘도 마침 프로필에 들어갔다 업데이트가 멈춘 Gist를 발견했고 <em>이걸 또 켜야해?</em> 라는 생각이 들어서 계속 활성화 할 수 있는 방법이 없는지 알아보았다.</p>\n<h2>keepalive-workflow</h2>\n<p>이 <a href=\"https://github.com/gautamkrishnar/keepalive-workflow\">workflow</a>는 45일간 커밋이 없을 시에 Github API를 이용하거나, 더미 커밋을 생성해서 workflow가 계속 활성화될 수 있도록 한다.</p>\n<h3>방법1 : 내 워크플로우에 step 추가</h3>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Github Action with a cronjob trigger\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">schedule</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">cron</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'0 0 * * *'</span>\n<span class=\"token key atrule\">permissions</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">actions</span><span class=\"token punctuation\">:</span> write\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">cronjob-based-github-action</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Cronjob based github action\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v4\n      <span class=\"token comment\"># - step 2</span>\n      <span class=\"token comment\"># - step n, use it as the last step</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> gautamkrishnar/keepalive<span class=\"token punctuation\">-</span>workflow@v2 <span class=\"token comment\"># using the workflow with default settings</span></code></pre></div>\n<p>마지막 스텝으로 keepalive-workflow를 추가한다.<br>\n다만 이 방법은 내가 실행하는 workflow가 여러개일 경우에 매번 추가해야 한다는 단점이 있다.</p>\n<details>\n<summary>별도 job으로 분리도 가능</summary>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Github Action with a cronjob trigger\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">schedule</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">cron</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'0 0 * * *'</span>\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">main-job</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Main Job\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v4\n      <span class=\"token comment\"># - step1</span>\n      <span class=\"token comment\"># - step 2</span>\n      <span class=\"token comment\"># - Step N</span>\n  <span class=\"token key atrule\">keepalive-job</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Keepalive Workflow\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\n    <span class=\"token key atrule\">permissions</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">actions</span><span class=\"token punctuation\">:</span> write\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v4\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> gautamkrishnar/keepalive<span class=\"token punctuation\">-</span>workflow@v2</code></pre></div>\n</details>\n<br>\n<h3>방법2: 별도 workflow로 분리</h3>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Keepalive Workflow\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">schedule</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">cron</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'0 0 * * *'</span>\n<span class=\"token key atrule\">permissions</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">actions</span><span class=\"token punctuation\">:</span> write\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">cronjob-based-github-action</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Keepalive Workflow\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v4\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> gautamkrishnar/keepalive<span class=\"token punctuation\">-</span>workflow@v2\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">workflow_files</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'build1.yml, build2.yml'</span>\n          <span class=\"token key atrule\">time_elapsed</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'0'</span></code></pre></div>\n<p>workflow_files에 크론잡이 수행되는 workflow의 이름을 추가해서 관리할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">push</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">branches</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> master\n  <span class=\"token key atrule\">schedule</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">cron</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'0 0 * * *'</span></code></pre></div>\n<p>내 <a href=\"https://github.com/minjj0905/github-stats-box\">github-stats-box</a> 레포지토리에 해당 workflow를 추가하고 push 시에도 작동하도록 추가해서 action이 실행되는 것을 확인해보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d87ea0e9d398efbca69b9b58528c1a69/9f82e/02.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.987730061349694%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABOklEQVR42pWSa2+DIBiFUeoNEQQVGkutpVW7xrlll2TL0n7d//9He21rty/LuuSBnAAHXg6gXJtq0y3XzcJY7MdoFjk3g2KWi6LkQseJdD3yL5AXUMrzgKTYI44bwH7Xub9PDgjPlIl5QVgGVURUOjga+bHLryfXzf3b8bN/+hheDieO+8f34fnQ9a/G9tV2OLOaxPdIMyCf8LRYmLqtNrul7UwN4bWAbXupTCLmidA0VQCTGjTA5DgIxSLkhkyo9m7Ydn2zfygru9p05dKOKUqdKehVkuaUZ6nUoxZFmmmwkEQiuBssWtm2NPXcrKu6Aed2N0A9yPGReyY44V965yRwgLyIcTmPqCBUEpZDeWEsrmmPYnaJ/ZLTbHoLCAzSlmoBHnC6fgz/ZJzA4U2fBBqePAiH6Dbb2fwFM64karY2SZcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"02\"\n        title=\"\"\n        src=\"/static/d87ea0e9d398efbca69b9b58528c1a69/a6d36/02.png\"\n        srcset=\"/static/d87ea0e9d398efbca69b9b58528c1a69/222b7/02.png 163w,\n/static/d87ea0e9d398efbca69b9b58528c1a69/ff46a/02.png 325w,\n/static/d87ea0e9d398efbca69b9b58528c1a69/a6d36/02.png 650w,\n/static/d87ea0e9d398efbca69b9b58528c1a69/9f82e/02.png 820w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span><br>\nAPI를 통해 정상 작동 하였고</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3f47b0bfe9494dfc5830de4f2bf11541/295bd/03.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 63.80368098159509%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB1UlEQVR42qVT23LbIBDV//9aknb60qa1EjuJLFnWFSMBAsHpLpJdudOHzoSZw7IXlr2R1HWNsjyjripUFZ3PTCt0vcB1WetwkQMkQQgZqbUzvA83ODdjVAZJ2Y7opSaDCcYYKKWhtcE0TTeHPvAFFy9FOrMzj0DyK6LN7JH0F4meolletfjsSuQwIDqlVBRF5ih8Sy/NG8ov2/9AjFDpCW1/gTYTmraHIOdcr6puqSYabSciz/p/w95gJoukUQ7V6NDoGTXRWs0rFlm18o32G90fsPyq68g++V4rPGQdHj9aPB0FvhYST7nAF8Ijyb+VAx4+umjzUwK/NkjFjLRo8OOtwGvZ4zhSyiV5zxUIAbnGciZ6HEME89lANmR8Nqt+RUGodCCQLtKAZF87HLIS+TFDnuc4nU7IsgxN09x1T7mAli6EjYxHh+fVUC15nHh8Eu4qd5mLz0ruNkMONJ/iQl338bKcAk4U5UznsEHTdrFplhzyLCbaLu2eaVjvsTgimxv+5tkB/yJs+OTQODy/vGO32yF92WN/eEOaviIvCoyjit+Kl6AIM+nhNzn74GOEbDfRyMSUeWNG07fjWvCZwS/znPk1NEM1FOa+hry6ro/l4azY4W+LqPDhXGXWaQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"03\"\n        title=\"\"\n        src=\"/static/3f47b0bfe9494dfc5830de4f2bf11541/a6d36/03.png\"\n        srcset=\"/static/3f47b0bfe9494dfc5830de4f2bf11541/222b7/03.png 163w,\n/static/3f47b0bfe9494dfc5830de4f2bf11541/ff46a/03.png 325w,\n/static/3f47b0bfe9494dfc5830de4f2bf11541/a6d36/03.png 650w,\n/static/3f47b0bfe9494dfc5830de4f2bf11541/295bd/03.png 667w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span><br>\n4개월전에 disabled 된 내 workflow가 enable 되었다! 😸</p>\n<p>같은 증상으로 고민하던 분들이 있다면 한번 적용해보시면 좋을 것 같다.</p>","fields":{"slug":"/keep-github-action-enabled/"},"frontmatter":{"title":"[Github Actions] 워크플로 비활성화 방지하기 keepalive-workflow","date":"2025-02-26","summary":"그만 좀 멈춰주라! github action","tags":["Github Actions"],"published":true,"thumbnail":{"publicURL":"/static/0d9e6aadf38672f7aab883616e64c8ec/01.png"}}}},"pageContext":{"slug":"/keep-github-action-enabled/"}},"staticQueryHashes":["3764592887"],"slicesMap":{}}